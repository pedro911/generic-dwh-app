<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{fragments/layout :: layout (~{::body},'query')}">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <form class="customizing" th:action="@{|/genericdwh/results/${db}|}" method="get">
                <!--<input type="hidden" name="combinations[]" value="">-->
                <div class="row">
                    <div class="col-md-12">
                        <div class="alert alert-success" role="alert">
                            Query Generic DWH TPC-H on DB Connection:  <a class="alert-link" th:text="${db}"/>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12 col-md-12">
                        <!--<br th:replace="genericdwh/_filters.html :: filters"/>-->
                    </div>
                </div>

                <div class="row">

                    <div class="col-sm-6 col-md-4">
                        <div class="card">
                            <div class="card-header">Ratios</div>
                            <div class="card-body">
                                <span class="row" th:include="genericdwh/_ratios.html :: ratios"></span>

                            </div>
                        </div>
                    </div>

                    <div class="col-sm-6 col-md-8">
                        <div class="card">
                            <div class="card-header">Dimensions</div>
                            <div class="card-body">
                                <div class="card-columns">
                                    <!--<span th:include="genericdwh/_dimensions.html :: dimensions" th:with="roots=${dimensionRoots}"></span>-->

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Customers</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="8" th:text="' Market Segment'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="9" th:text="' Customer'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="5" th:text="' Order'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="6" th:text="' Product'">
                                        </div>
                                    </div>

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Manufacturer Groups</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="14" th:text="' Manufacturer Group'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="15" th:text="' Brand'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="6" th:text="' Product'">
                                        </div>
                                    </div>

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Market Locations</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="11" th:text="' Region'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="12" th:text="' Nation'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="9" th:text="' Customer'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="5" th:text="' Order'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="6" th:text="' Product'">
                                        </div>
                                    </div>

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Orders</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="1" th:text="' Order Priority'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="4" th:text="' Order Status'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="2" th:text="' Ship Priority'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="3" th:text="' Clerk'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="5" th:text="' Order'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="6" th:text="' Product'">
                                        </div>
                                    </div>

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Products</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="21" th:text="' Container'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="4" th:text="' Product Status'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="20" th:text="' Return Flag'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="18" th:text="' Ship Instruct'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="17" th:text="' Ship Mode'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="22" th:text="' Size'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="23" th:text="' Type'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="6" th:text="' Product'">
                                        </div>
                                    </div>

                                    <div class="card border-dark mb-3">
                                        <div class="card-header">Date</div>
                                        <div class="card-body">
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="25" th:text="' Year'"><br>
                                            <input class="dimension" type="checkbox" th:name="dimensionChecked" th:value="26" th:text="' Month'">
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        </br>
                        <div class="row">
                            <div class="col-lg-12">
                                <button type="submit" class="btn btn-primary float-right">Preview</button>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <br/>
                                <div class="validation-msg">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script type="text/javascript">
                    $(function() {

                        $(document).on('submit', 'form.customizing', function() {
                            var is_valid = validate_form();
                            if (!is_valid) {
                                return false;
                            }
                        });

                        $(document).on('change', $('[name="ratioChecked"]'), function() {
                            $('.validation-msg').empty();
                            validate_form();
                        });

                        $(document).on('change', $('[name="dimensionChecked"]'), function() {
                            $('.validation-msg').empty();
                            validate_form();
                        });

                        $('.validation-msg').empty();
                        var is_valid = true;

                        validate_form = function() {
                            var ratio_count = $('[name="ratioChecked"]:checked').length;
                            var dimension_count = $('[name="dimensionChecked"]:checked').length;
                            var is_valid = true;

                            if (ratio_count == 0 || dimension_count ==0) {
                                is_valid = false;
                                $('.validation-msg').append($('<div/>', { class: 'alert alert-danger' }).html('You have to select at least one ratio and one dimension.'));
                            } else {
                                var is_valid = true;
                            }

                            if (is_valid) {
                                $('button[type="submit"]').removeAttr('disabled');
                            } else {
                                $('button[type="submit"]').attr('disabled','disabled');
                            }
                            return is_valid;
                        };
                        validate_form();
                    });
                </script>

            </form>
        </div>
    </div>
</div> <!-- /container -->
</body>
</html>